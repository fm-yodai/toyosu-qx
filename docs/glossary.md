# 用語集（豊洲QX ターレ運用シミュレーション）

## 1. 走行体・主体

| 用語        | 定義                                  | 注釈                                            |
| --------- | ----------------------------------- | --------------------------------------------- |
| ターレ       | 市場内を走行する小型運搬車。1回の最大積載200kgを上限とする走行体 | 状態（idle/moving/loading）、現在位置、積載量、所属仲卸などの属性を持つ |
| 仲卸        | 市場内の卸売事業者。ターレを保有し、自社・共同運用で配送を実施     | 「所属仲卸」はターレのデフォルト帰還先                           |
| 小売（納品先）   | ターレの配送先。小売トラックの駐車位置を1ノードとして扱う       | 需要（注文）は時間帯強度・バスケットで表現                         |
| ドライバ      | ターレの運転者としてモデル化される資源（必要に応じて分離）       | Phase 1ではターレに内包、Phase 2で別資源に拡張可               |
| オーダ（配送要求） | 小売から発生する配送要求。10/30/50kgの口で構成        | キューに滞留し、割当/再割当の対象                             |

## 2. 時間・イベント

| 用語                          | 定義                            | 注釈                    |
| --------------------------- | ----------------------------- | --------------------- |
| シミュレーション日                   | 市場1日分の稼働時間帯（例：4:00–12:00）     | ピーク/閑散帯を含む            |
| 離散事象シミュレーション（DES）           | 1秒粒度・イベント駆動で進行するシミュレーション方式    | SimPyなどのイベントキューで実装    |
| 主要イベント                      | 積込開始/終了、出発/到着、荷下ろし開始/終了、取引確定  | 発生時に次イベントを予約し、時刻順に処理  |
| 10秒逐次最適化（Optimization Tick） | 10〜30秒間隔で状態スナップショットを取得し再割当を実施 | 間隔は計算負荷と精度のトレードオフで調整  |
| イベントキュー                     | 全イベントを時刻順に管理するキュー構造           | 秒精度で処理、同時刻イベントは優先度で整列 |

## 3. データ構造

| 用語         | 定義                                   | 注釈                   |
| ---------- | ------------------------------------ | -------------------- |
| 市場レイアウトグラフ | 店舗・駐車位置・倉庫などをノード化したグラフ               | エッジは距離・移動時間を保持（距離行列） |
| 距離行列       | ノード間の最短距離（時間換算に使用）                   | 速度8km/hを基準に所要時間へ変換   |
| ターレオブジェクト  | ターレの状態・属性・スケジュールを保持するモデル要素           | ID、現在ノード、残積載量、割当タスク等 |
| 仲卸オブジェクト   | 保有ターレ、未処理配送キュー、帰還先ノードを保持             | キュー運用ポリシーを内包         |
| ログ（イベントログ） | {時刻, ターレID, 状態, 位置, 積載量, イベント種別} の記録 | 集計・可視化・再現用の一次データ     |
| シナリオ       | 乱数シード、需要曲線、運用ルールセットを束ねた入力一式          | 感度分析・比較実験の単位         |

## 4. 運用ルール・パラメータ

| 用語            | 定義                         | 注釈                            |
| ------------- | -------------------------- | ----------------------------- |
| 最大積載量         | ターレ1便あたりの上限重量              | 初期値200kg                      |
| 取引タイプ（S/M/L）  | 10/30/50kgの口（lot）単位        | 積載判断・需要生成の最小粒度                |
| 5分以内ルール（取引成立） | 積載開始から5分（300秒）追加が無ければ現量で確定 | 待機し過ぎによる遅延防止                  |
| 平均走行速度        | 市場内の想定平均速度                 | 初期値8km/h（約2.2m/s）             |
| 工程時間モデル       | 積込/荷下ろし時間 t=α·W+β（線形）      | 例：α=0.3 s/kg, β=10 s；取引処理は30秒 |
| 混載ポリシー        | 1便に複数口を積み合わせる方針            | 初期は「同一宛先のみ許容」                 |
| 帰還/次ピック       | 配送後の挙動                     | 初期は仲卸へ帰還、最適化ONで次ジョブ直行可        |
| 出発トリガ         | 最低積載・滞在時間・締切等の条件で出発を決定     | 例：5分経過、あるいは満載近傍で出発            |

## 5. 成果指標（KPI）

| 用語       | 定義                  | 注釈              |
| -------- | ------------------- | --------------- |
| 稼働時間     | ターレが稼働状態（走行/作業）の総秒数 | 台数別・時間帯別に集計可    |
| 稼働率      | 稼働時間/総稼働可能時間        | 0〜1で表現          |
| 走行距離     | 1日合計の移動距離           | 距離行列×経路で算出      |
| 1便平均積載率  | 1便重量/200kgの平均       | 0〜1；満載効率の proxy |
| リードタイム   | 到着時刻−注文時刻の分布        | 平均・95%点を重視      |
| 充足率      | 注文重量に対する納品重量の比率     | 分割納品含め最終充足で評価   |
| 分割納品率    | 1注文が複数便に分割された割合     | 利便・効率のトレードオフ    |
| 販売消化率    | 仲卸側の販売予定に対する処理済み割合  | 在庫・滞留の指標        |
| 待機在庫時間   | 注文確定〜積込開始までの平均/最大   | ボトルネック特定に有効     |
| タスク待ち行列長 | 未割当オーダの平均/最大キュー長    | 需給ギャップの即時指標     |

## 6. アルゴリズム・最適化

| 用語            | 定義                      | 注釈                      |
| ------------- | ----------------------- | ----------------------- |
| プランナ（Planner） | 割当・経路・発車時刻を決める意思決定モジュール | ルール→OR-Tools→量子の段階導入を想定 |
| ルールベース割当      | 近傍空車・最短到着・先着先出などの単純規則   | Phase 1の初期実装            |
| 再最適化（リプラン）    | Tickごとに割当・経路を再計算する手順    | 10〜30秒おきに適用             |
| 量子最適化         | QAOA/アニーリング等のハイブリッド最適化  | 部分問題（束ね方・積載）へ適用を検討      |
| 制約条件          | 容量・時間窓・締切・帰還先などの制約集合    | 破る場合はペナルティ付与            |

## 7. 可視化・出力

| 用語            | 定義                   | 注釈                 |
| ------------- | -------------------- | ------------------ |
| 2Dアニメーション再生   | 時系列のターレ位置・状態を再生表示    | 再生速度変更・停止/巻戻し対応    |
| ダッシュボード       | KPIの時系列・分布・集計を表示する画面 | ヒートマップ、箱ひげ、時系列ライン等 |
| サンキー図         | 便あたりの混載・流れを可視化する図    | 仲卸→小売のフロー強度を可視化    |
| CSV/Parquet出力 | ログ・KPI・サマリの保存形式      | 解析ツール連携を想定         |

## 8. 検証・品質

| 用語          | 定義                         | 注釈                        |
| ----------- | -------------------------- | ------------------------- |
| 一貫性チェック     | 需要=供給（在庫・未充足の整合）を確認        | 不一致時は原因（締切・容量）を分類         |
| 感度分析        | 速度・α/β・出発トリガ等の変化によるKPI影響評価 | シナリオ比較でロバスト性を検証           |
| ベンチマークシナリオ  | 比較用の固定パラメータ・固定乱数種のシナリオ     | 回帰テストの基準                  |
| DoD（受け入れ条件） | 完了判定条件の集合                  | KPI算出・基準シナリオ再現・最適化フック実装など |

