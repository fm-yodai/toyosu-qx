# Project Outline — 豊洲QX「ターレ共同運用×最適化」比較検証

## Background
- 本プロジェクトは**豊洲市場の構内物流**に焦点。現在は**仲卸ごとの個別ターレ運用**が主で、**低積載・重複走行・待機**が常態化している。
- これを踏まえ、**仲卸横断の共同運用モデル**を検討し、実運用で有効な意思決定材料（数値根拠）を得たい。

## Goal / Why
- **共同運用**で上記の非効率（低積載・重複走行・待機）を**どれだけ削減できるか**を定量化する。
- **古典最適化 vs 量子最適化（アニーリング/QAOA）**の**実務的優位性**（性能・解品質・安定性・運用適合性）を、**同一条件の数値実験**で明らかにする。

## What
- **シミュレーション基盤**：一般化した市場の**2D空間**上で、仲卸→小売の物流を**秒粒度**で再現（ターレ状態 idle/load/move、位置(x,y)、速度）。
- **比較フェーズ（同一シナリオ・同一Seed）**
  1) ルールベース割当（ベースライン）
  2) 古典最適化（容量・時間制約下の配車/経路）
  3) 量子アニーリング最適化
  4) 量子ゲート式（QAOA）最適化
- **KPI可視化と統計比較**：稼働率、平均積載率、走行距離、リードタイム分布（平均/95%）、分割納品率、待機在庫時間、未充足率、計算時間・再計画周期。

## Codebase Requirement
- **強い要望**：**再現可能な数値実験コードベース**を構築してほしい。  
  - **シナリオ管理**（レイアウト・需要プロファイル・混雑係数）と**乱数Seed固定**  
  - **バッチ実行**（複数フェーズ/複数Seedの自動比較）、**ログとパラメータの完全保存**  
  - **自動レポート**（KPI表・比較グラフ・結論サマリ）生成  
  - 研究フェーズは**Pythonスタックに統一**（Simpy, marimo, polars, plotly, etc.）

## Experimental Design
- **データ生成**：2Dレイアウト（ノード/座標）＋**ルール付きランダム需要**（時間帯強度、S/M/Lバスケット、宛先分布）。
- **公平性**：すべての手法を**同一シナリオ×同一Seed**で**反復**し、**平均と分散**で評価。
- **出力管理**：各Runで `events`・`kpi`・`meta` を保存し、**比較レポート（HTML）**を作成。

## Success Criteria
- ベースライン比で主要KPIの**改善度**が明確（例：走行距離▲X%、平均積載率＋Ypt、LT95%▲Z%）。
- **計算時間・安定性（解のばらつき）**のプロファイルを提示し、**現実的な再計画周期**を示せる。
- 量子手法の**適用/非適用の境界条件**（問題規模・制約強度・時間制約）を整理。

## Constraints / Non-goals
- 実データは使わず**合成データ**（PIIなし）。  
- 本番インフラ、複雑なUIは**対象外**。研究検証に必要な**シミュレーションと可視化**に限定。  
- **再現性重視**（パラメータ・Seed・ログ完全保存）。

## Deliverables
- **比較レポート**：ベースライン/古典/量子A/量子G のKPI表、主要グラフ、結論サマリ。  
- **シナリオ定義とログ一式**（再現可能な形で提供）。  
- **2Dアニメーション動画**：ターレの**状態・位置・動き**を**1秒刻み**で可視化した動画（またはHTMLアニメーション）。**各Runごとに出力**。  
- **示唆メモ**：共同運用導入の開始条件・推奨ルール、量子活用の適用指針。

## Milestones
- M1: ベースライン実装＋KPI算出  
- M2: 古典最適化の比較  
- M3: 量子アニーリングの比較  
- M4: QAOAの比較＋総合レポート（動画含む）